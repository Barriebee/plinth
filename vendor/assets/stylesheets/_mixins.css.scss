//
// Mixins to help reduce verbose repeating markup
// @author Ad Taylor
//

// ==========================================================================
// Create column sizes
// ==========================================================================

@mixin create-column-sizes($grids) {
  $query-pos: 4;
  @each $grid in $grids {
    // If there is a media query
    @if(length($grid) == 1){}
    @else if(length($grid) == $query-pos) {

      .#{nth($grid,1)}only {
        display: none !important;
      }

      // Add Rules wrapped in media query
      @include media-query( nth($grid,$query-pos)) {
        @include build-column-size($grid);
        .#{nth($grid,1)}only {
          display: block !important;
        }

        .#{nth($grid,1)}hide {
          display: none !important;
        }
      }
    }
    @else {
      @include build-column-size($grid);
    }
  }
}

@mixin build-column-size($grid) {
  $padding-pos: 3;
  $total-columns: nth($grid,2);
  @if(length($grid) >= $padding-pos ) {
    .column {
      padding: 0 (0.5 * nth($grid,$padding-pos));
      @if($total-columns == 1){
        float: none;
        width: auto;
        right: auto;
        left: auto;
      }
    }
  }

  @if($total-columns > 1) {
    @for $i from 1 through $total-columns {
      .#{nth($grid,1)}#{convert-number-to-word($i)} {
        width: gridCalc($i, $total-columns);
      }
      .#{nth($grid,1)}push-#{convert-number-to-word($i)} {
        left: gridCalc($i, $total-columns);
      }
      .#{nth($grid,1)}pull-#{convert-number-to-word($i)} {
        right: gridCalc($i, $total-columns);
      }
    }
    .#{nth($grid,1)}push-none {
      left: 0;
    }
    .#{nth($grid,1)}pull-none {
      right: 0;
    }
  }


}

// ==========================================================================
// Conditional CSS - JS Detection
// ==========================================================================

@mixin conditional-CSS($grids) {
  $query-pos: 4;

  @each $grid in $grids {
    @if(length($grid) < $query-pos){
      body:after {
        content: nth($grid,1);;
        display: none;
      }
    }
    @else {
      @include media-query( nth($grid,$query-pos)) {
        body:after {
          content: nth($grid,1);;
          display: none;
        }
      }
    }
  }
}

// ==========================================================================
// Simple Media Query Generator
// ==========================================================================

@mixin media-query($size) {
  @media ($size) {
    @content;
  }
}

// ==========================================================================
// Micro Clearfix - Nicolas Gallagher
// ==========================================================================

@mixin clearfix() { *zoom:1;
  &:before, &:after { content: ""; display: table; }
  &:after { clear: both; }
}

// ==========================================================================
// Internet Explorer Fixes
// ==========================================================================

// IE7 inline-block ~ twitter bootstrap

@mixin ie7-inline-block {
  *display: inline;
  *zoom: 1;
}

// IE7 likes to collapse whitespace on either side of the inline-block elements.
// Ems because we're attempting to match the width of a space character. Left
// version is for form buttons, which typically come after other elements, and
// right version is for icons, which come before. Applying both is ok, but it will
// mean that space between those elements will be .6em (~2 space characters) in IE7,
// instead of the 1 space in other browsers.  ~ twitter bootstrap

@mixin ie7-restore-left-whitespace {
  *margin-left: .3em;

  &:first-child {
    *margin-left: 0;
  }
}

// ==========================================================================
// Accessibility
// ==========================================================================

@mixin set-focus {
  outline: 3px solid yellow;
}


// ==========================================================================
// Uncle Dave's Ol' Padded Box
// ==========================================================================

@mixin ol-padded-box($ratioW, $ratioH) {
  background-size: cover;
  height: 0;
  display: block;
  padding-bottom: 0% + ($ratioH/$ratioW)*100;
}


// ==========================================================================
// Smallest query
// ==========================================================================

@mixin smallest-query {
  $query-position: 4;
  $length: length($grids);
  $mobile: nth($grids, $length);

  @include media-query( nth($mobile,$query-position)) {
    @content;
  }
}
